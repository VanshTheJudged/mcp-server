<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Company Profile</title>

    <style>
        body {
            font-family: Inter, Arial, sans-serif;
            background: #f5f7fa;
            margin: 0;
            padding: 30px;
        }
        .card {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            box-shadow: 0 8px 22px rgba(0, 0, 0, 0.06);
            max-width: 780px;
            margin: auto;
        }
        .header {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .icon {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            background: #4C82F7;
        }
        h2 { margin: 0; font-size: 28px; font-weight: 700; }
        .funding { font-size: 15px; margin: 6px 0 18px 0; color: #444; }

        .scores { display: flex; flex-direction: column; gap: 10px; margin-bottom: 18px; }
        .score-box { padding: 4px 7px; border-radius: 10px; font-size: 15px; display: inline-flex; gap: 8px; font-weight: 600; }
        .green { background: #E3FAEA; color: #059669; }
        .pink { background: #FFE2F4; color: #D946EF; }

        .legend { display: flex; gap: 20px; margin-bottom: 10px; }
        .dot { width: 14px; height: 14px; border-radius: 50%; }
        .dot.pink { background: #EC07B5; }
        .dot.green { background: #00C793; }

        .chart { height: 350px; margin-top: 20px; padding-left: 40px; }

        .about-card, .activity-section, .people-card {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            box-shadow: 0 8px 22px rgba(0,0,0,0.06);
            max-width: 780px;
            margin: 30px auto;
        }

        .info-list { list-style: none; padding: 0; margin: 0; }
        .info-list li { display: flex; gap: 10px; margin-bottom: 10px; }
        .tag { padding: 8px 14px; background: #eef2f8; border-radius: 20px; font-size: 13px; }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="card">
        <div class="header">
            <div class="icon"></div>
            <h2 id="companyName">Loading...</h2>
        </div>

        <div class="funding">
            Total Funding <span id="totalFunding">--</span>
        </div>

        <div class="scores">
            <div class="score-box green">Growth Score <span id="growth">98</span></div>
            <div class="score-box pink">Heat Score <span id="heat">93</span></div>
        </div>

        <div class="legend">
            <div><span class="dot pink"></span> Heat</div>
            <div><span class="dot green"></span> Growth</div>
        </div>

        <div class="chart">
            <canvas id="myChart"></canvas>
        </div>
    </div>

    <div class="about-card">
        <h3>About <span id="aboutName">Company</span></h3>

        <p id="aboutDescription">Loading description...</p>

        <ul class="info-list">
            <li>üìÖ Founded: <span id="foundedDate">--</span></li>
            <li>üè¢ Industry: <span id="industry">--</span></li>
            <li>üìç Country: <span id="location">--</span></li>
            <li>üë• Employees: <span id="employees">--</span></li>
            <li>üí∞ Revenue: <span id="revenue">--</span></li>
            <li>üîó Website: <a id="website" href="#">--</a></li>
        </ul>

        <div id="tagsContainer"></div>
    </div>

    <div class="activity-section">
        <h3>Activity</h3>
        <p>Industry: <span id="activityIndustry">--</span></p>
    </div>

    <div class="people-card">
        <h3>People</h3>
        <p>Headcount: <span id="peopleHeadcount">--</span></p>
        <p>Founder: <span id="founderName">--</span></p>
        <p>Country: <span id="peopleCountry">--</span></p>
    </div>

<script>
    function hydrateProfile() {
        const toolOutput = window?.openai?.toolOutput;
        if (!toolOutput || !toolOutput.company) {
            return;
        }

        const c = toolOutput.company;
        const safe = (v, fallback = "N/A") =>
            v === undefined || v === null || v === "" || v === "no_data" ? fallback : v;

        document.getElementById('pageTitle').textContent = `${safe(c.company_name)} Profile`;

        document.getElementById('companyName').textContent = safe(c.company_name);
        document.getElementById('aboutName').textContent = safe(c.company_name);
        document.getElementById('aboutDescription').textContent =
            `${safe(c.company_name)} is a ${safe(c.industry)} company founded in ${safe(c.year_founded)}, based in ${safe(c.country)}.`;

        document.getElementById('foundedDate').textContent = safe(c.year_founded);
        document.getElementById('industry').textContent = safe(c.industry);
        document.getElementById('location').textContent = safe(c.country);
        document.getElementById('employees').textContent = safe(c.employee_count);
        document.getElementById('revenue').textContent = safe(
            c.annual_revenue_usd ? `$${c.annual_revenue_usd}` : "N/A"
        );
        document.getElementById('founderName').textContent = safe(c.founder);
        document.getElementById('peopleHeadcount').textContent = safe(c.employee_count);
        document.getElementById('peopleCountry').textContent = safe(c.country);
        document.getElementById('activityIndustry').textContent = safe(c.industry);

        const website = document.getElementById('website');
        const url = safe(c.website, "");
        if (url) {
            website.href = url.startsWith("http") ? url : "https://" + url;
            website.textContent = url.replace(/^https?:\/\//, "");
        } else {
            website.href = "#";
            website.textContent = "N/A";
        }

        const tagsContainer = document.getElementById("tagsContainer");
        tagsContainer.innerHTML = "";
        if (c.industry) {
            const tag = document.createElement("span");
            tag.className = "tag";
            tag.textContent = c.industry;
            tagsContainer.appendChild(tag);
        }

        const ctx = document.getElementById("myChart");
        if (ctx && !ctx._chartInstance) {
            ctx._chartInstance = new Chart(ctx, {
                type: "line",
                data: {
                    labels: ["Jan","Feb","Mar","Apr","May","Jun"],
                    datasets: [
                        {
                            label: "Growth",
                            data: [85, 88, 90, 92, 95, 98],
                            borderColor: "#00C793",
                            fill: false
                        },
                        {
                            label: "Heat",
                            data: [80, 83, 86, 88, 91, 93],
                            borderColor: "#EC07B5",
                            fill: false
                        }
                    ]
                }
            });
        }
    }

    document.addEventListener("DOMContentLoaded", hydrateProfile);
    window.addEventListener("openai:set_globals", hydrateProfile);
</script>

</body>
</html>
